(()=>{var e={};e.id=744,e.ids=[744],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{"use strict";e.exports=require("crypto")},5315:e=>{"use strict";e.exports=require("path")},1748:(e,t,i)=>{"use strict";let n;i.r(t),i.d(t,{originalPathname:()=>G,patchFetch:()=>X,requestAsyncStorage:()=>K,routeModule:()=>z,serverHooks:()=>W,staticGenerationAsyncStorage:()=>V});var r={};i.r(r),i.d(r,{GET:()=>B,POST:()=>H});var s=i(9303),a=i(8716),o=i(670),l=i(8277),c=i(4770);let d=require("fs");var u=i(5315),h=((n=h||{}).INITIALIZATION_ERROR="INITIALIZATION_ERROR",n.VALIDATION_ERROR="VALIDATION_ERROR",n.TASK_NOT_FOUND="TASK_NOT_FOUND",n.TASK_ALREADY_CONFIRMED="TASK_ALREADY_CONFIRMED",n.TASK_EXPIRED="TASK_EXPIRED",n.INSUFFICIENT_EVIDENCE="INSUFFICIENT_EVIDENCE",n.API_ERROR="API_ERROR",n.NETWORK_ERROR="NETWORK_ERROR",n.EXPORT_ERROR="EXPORT_ERROR",n.ANOMALY_CONFIG_ERROR="ANOMALY_CONFIG_ERROR",n),g=class extends Error{constructor(e,t,i){super(t),this.name="KontextError",this.code=e,this.details=i}},p={actions:"kontext:actions",transactions:"kontext:transactions",tasks:"kontext:tasks",anomalies:"kontext:anomalies"},m=class{setStorageAdapter(e){this.storageAdapter=e}getStorageAdapter(){return this.storageAdapter}async flush(){this.storageAdapter&&await Promise.all([this.storageAdapter.save(p.actions,this.actions),this.storageAdapter.save(p.transactions,this.transactions),this.storageAdapter.save(p.tasks,Array.from(this.tasks.entries())),this.storageAdapter.save(p.anomalies,this.anomalies)])}async restore(){if(!this.storageAdapter)return;let[e,t,i,n]=await Promise.all([this.storageAdapter.load(p.actions),this.storageAdapter.load(p.transactions),this.storageAdapter.load(p.tasks),this.storageAdapter.load(p.anomalies)]);Array.isArray(e)&&(this.actions=e),Array.isArray(t)&&(this.transactions=t),Array.isArray(i)&&(this.tasks=new Map(i)),Array.isArray(n)&&(this.anomalies=n)}addAction(e){this.actions.push(e)}getActions(){return[...this.actions]}queryActions(e){return this.actions.filter(e)}getActionsByAgent(e){return this.actions.filter(t=>t.agentId===e)}addTransaction(e){this.transactions.push(e)}getTransactions(){return[...this.transactions]}queryTransactions(e){return this.transactions.filter(e)}getTransactionsByAgent(e){return this.transactions.filter(t=>t.agentId===e)}getRecentTransactions(e,t){return this.transactions.filter(t=>t.agentId===e).slice(-t)}addTask(e){this.tasks.set(e.id,e)}getTask(e){return this.tasks.get(e)}updateTask(e,t){let i=this.tasks.get(e);if(!i)return;let n={...i,...t};return this.tasks.set(e,n),n}getTasks(){return Array.from(this.tasks.values())}queryTasks(e){return Array.from(this.tasks.values()).filter(e)}addAnomaly(e){this.anomalies.push(e)}getAnomalies(){return[...this.anomalies]}queryAnomalies(e){return this.anomalies.filter(e)}getCounts(){return{actions:this.actions.length,transactions:this.transactions.length,tasks:this.tasks.size,anomalies:this.anomalies.length}}clear(){this.actions=[],this.transactions=[],this.tasks.clear(),this.anomalies=[]}constructor(){this.actions=[],this.transactions=[],this.tasks=new Map,this.anomalies=[],this.storageAdapter=null}},f=new Set(["digest","priorDigest"]),b="0".repeat(64),w=class{constructor(){this.links=[],this.currentDigest=b,this.hrtimeBase=process.hrtime.bigint()}append(e){let t=this.getPrecisionTimestamp(),i=this.serialize(e),n=this.deriveSalt(t),r=this.currentDigest,s=this.computeDigest(r,i,n),a={digest:s,priorDigest:r,salt:n,timestamp:t,sequence:this.links.length,actionId:e.id};return this.links.push(a),this.currentDigest=s,a}getTerminalDigest(){return this.currentDigest}getChainLength(){return this.links.length}getLinks(){return this.links}getLink(e){return this.links[e]}verify(e){let t=performance.now();if(e.length!==this.links.length)return{valid:!1,linksVerified:0,firstInvalidIndex:0,verificationTimeMs:performance.now()-t,terminalDigest:this.currentDigest};let i=b;for(let n=0;n<this.links.length;n++){let r=this.links[n],s=e[n],a=this.serialize(s),o=this.computeDigest(i,a,r.salt);if(o!==r.digest)return{valid:!1,linksVerified:n,firstInvalidIndex:n,verificationTimeMs:performance.now()-t,terminalDigest:this.currentDigest};i=o}return{valid:!0,linksVerified:this.links.length,firstInvalidIndex:-1,verificationTimeMs:performance.now()-t,terminalDigest:this.currentDigest}}verifyLink(e,t,i){let n=this.serialize(t);return this.computeDigest(i,n,e.salt)===e.digest}exportChain(){return{genesisHash:b,links:[...this.links],terminalDigest:this.currentDigest}}computeDigest(e,t,i){let n=(0,c.createHash)("sha256");return n.update(e),n.update(t),n.update(i),n.digest("hex")}serialize(e){return function(e){let t=Object.keys(e).filter(e=>!f.has(e)).sort();return JSON.stringify(e,t)}(e)}deriveSalt(e){let t=(0,c.createHash)("sha256");return t.update(e.hrtime.toString()),t.digest("hex")}getPrecisionTimestamp(){let e=process.hrtime.bigint(),t=Number((e-this.hrtimeBase)%1000000n);return{iso:new Date().toISOString(),hrtime:e,microseconds:t}}};function y(){if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=Date.now().toString(36),t=Math.random().toString(36).substring(2,10);return`${e}-${t}`}function v(){return new Date().toISOString()}function A(e,t,i){let n="string"==typeof e?new Date(e):e;return n>=t&&n<=i}function k(e){return parseFloat(e)}function x(e){return/^0x[a-fA-F0-9]{40}$/.test(e)}function I(e){if(0===e.length)return"";let t=e[0];if(!t)return"";let i=Object.keys(t);return[i.join(","),...e.map(e=>i.map(t=>{let i=e[t];if(null==i)return"";let n="object"==typeof i?JSON.stringify(i):String(i);return n.includes(",")||n.includes('"')||n.includes("\n")?`"${n.replace(/"/g,'""')}"`:n}).join(","))].join("\n")}function T(e,t,i){return Math.min(Math.max(e,t),i)}var R=class{constructor(e,t){this.batch=[],this.flushTimer=null,this.config=e,this.store=t,this.digestChain=new w,this.batchSize=e.batchSize??50,this.flushIntervalMs=e.flushIntervalMs??5e3,this.isCloudMode=!!e.apiKey,this.flushTimer=setInterval(()=>{this.flush()},this.flushIntervalMs),this.flushTimer&&"object"==typeof this.flushTimer&&"unref"in this.flushTimer&&this.flushTimer.unref()}async log(e){let t={id:y(),timestamp:v(),projectId:this.config.projectId,agentId:e.agentId,correlationId:e.correlationId??y(),type:e.type,description:e.description,metadata:e.metadata??{}},i=this.digestChain.append(t);return t.digest=i.digest,t.priorDigest=i.priorDigest,this.store.addAction(t),this.batch.push(t),this.batch.length>=this.batchSize&&await this.flush(),this.config.debug&&this.debugLog("Action logged",t),t}async logTransaction(e){this.validateTransactionInput(e);let t=e.correlationId??y(),i={id:y(),timestamp:v(),projectId:this.config.projectId,agentId:e.agentId,correlationId:t,type:"transaction",description:`${e.token} transfer of ${e.amount} on ${e.chain}`,metadata:{...e.metadata},txHash:e.txHash,chain:e.chain,amount:e.amount,token:e.token,from:e.from,to:e.to},n=this.digestChain.append(i);return i.digest=n.digest,i.priorDigest=n.priorDigest,this.store.addTransaction(i),this.store.addAction(i),this.batch.push(i),this.batch.length>=this.batchSize&&await this.flush(),this.config.debug&&this.debugLog("Transaction logged",i),i}async flush(){if(0===this.batch.length)return;let e=[...this.batch];this.batch=[],this.isCloudMode?await this.flushToApi(e):this.flushToFile(e)}async destroy(){this.flushTimer&&(clearInterval(this.flushTimer),this.flushTimer=null),await this.flush()}getTerminalDigest(){return this.digestChain.getTerminalDigest()}getDigestChain(){return this.digestChain}verifyChain(e){return this.digestChain.verify(e)}validateTransactionInput(e){let t=k(e.amount);if(isNaN(t)||t<0)throw new g("VALIDATION_ERROR",`Invalid transaction amount: ${e.amount}`,{field:"amount",value:e.amount});if(!e.txHash||""===e.txHash.trim())throw new g("VALIDATION_ERROR","Transaction hash is required",{field:"txHash"});if(!e.from||""===e.from.trim())throw new g("VALIDATION_ERROR","Sender address (from) is required",{field:"from"});if(!e.to||""===e.to.trim())throw new g("VALIDATION_ERROR","Recipient address (to) is required",{field:"to"});let i=["ethereum","base","polygon","arbitrum","optimism","arc","avalanche","solana"];if(!i.includes(e.chain))throw new g("VALIDATION_ERROR",`Invalid chain: ${e.chain}. Must be one of: ${i.join(", ")}`,{field:"chain",value:e.chain});let n=["USDC","USDT","DAI","EURC"];if(!n.includes(e.token))throw new g("VALIDATION_ERROR",`Invalid token: ${e.token}. Must be one of: ${n.join(", ")}`,{field:"token",value:e.token})}flushToFile(e){let t=this.config.localOutputDir??".kontext",i=u.join(t,"logs");try{d.mkdirSync(i,{recursive:!0});let t=`actions-${new Date().toISOString().split("T")[0]}.jsonl`,n=u.join(i,t),r=e.map(e=>JSON.stringify(e)).join("\n")+"\n";d.appendFileSync(n,r,"utf-8")}catch(e){this.config.debug&&this.debugLog("Failed to write log file",{error:e})}}async flushToApi(e){let t=this.config.apiUrl??"https://kontext-api-421314897784.us-central1.run.app";try{let i=await fetch(`${t}/v1/actions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`,"X-Project-Id":this.config.projectId},body:JSON.stringify({actions:e})});if(!i.ok)throw new g("API_ERROR",`API request failed with status ${i.status}`,{status:i.status})}catch(t){if(t instanceof g)throw t;this.config.debug&&this.debugLog("API flush failed, falling back to local file",{error:t}),this.flushToFile(e)}}debugLog(e,t){let i=v();console.debug(`[Kontext ${i}] ${e}`,t?JSON.stringify(t,null,2):"")}},S=class{constructor(e,t){this.config=e,this.store=t}async createTask(e){this.validateCreateInput(e);let t=y(),i=v(),n=e.expiresInMs??864e5,r={id:t,projectId:this.config.projectId,description:e.description,agentId:e.agentId,status:"pending",requiredEvidence:e.requiredEvidence,providedEvidence:null,correlationId:e.correlationId??y(),createdAt:i,updatedAt:i,confirmedAt:null,expiresAt:new Date(Date.now()+n).toISOString(),metadata:e.metadata??{}};return this.store.addTask(r),this.config.debug&&console.debug(`[Kontext] Task created: ${t} - ${e.description}`),r}async confirmTask(e){let t=this.store.getTask(e.taskId);if(!t)throw new g("TASK_NOT_FOUND",`Task not found: ${e.taskId}`,{taskId:e.taskId});if("confirmed"===t.status)throw new g("TASK_ALREADY_CONFIRMED",`Task already confirmed: ${e.taskId}`,{taskId:e.taskId,confirmedAt:t.confirmedAt});if(t.expiresAt&&new Date(t.expiresAt)<new Date)throw this.store.updateTask(e.taskId,{status:"expired",updatedAt:v()}),new g("TASK_EXPIRED",`Task has expired: ${e.taskId}`,{taskId:e.taskId,expiresAt:t.expiresAt});let i=this.findMissingEvidence(t.requiredEvidence,e.evidence);if(i.length>0)throw new g("INSUFFICIENT_EVIDENCE",`Missing required evidence: ${i.join(", ")}`,{taskId:e.taskId,missingEvidence:i});let n=v(),r=this.store.updateTask(e.taskId,{status:"confirmed",providedEvidence:e.evidence,confirmedAt:n,updatedAt:n});if(!r)throw new g("TASK_NOT_FOUND",`Failed to update task: ${e.taskId}`,{taskId:e.taskId});return this.config.debug&&console.debug(`[Kontext] Task confirmed: ${e.taskId}`),r}async getTaskStatus(e){let t=this.store.getTask(e);if(t)return t.expiresAt&&"pending"===t.status&&new Date(t.expiresAt)<new Date?this.store.updateTask(e,{status:"expired",updatedAt:v()}):t}async startTask(e){let t=this.store.getTask(e);if(!t)throw new g("TASK_NOT_FOUND",`Task not found: ${e}`,{taskId:e});if("pending"!==t.status)throw new g("VALIDATION_ERROR",`Task cannot be started from status: ${t.status}`,{taskId:e,currentStatus:t.status});let i=this.store.updateTask(e,{status:"in_progress",updatedAt:v()});if(!i)throw new g("TASK_NOT_FOUND",`Failed to update task: ${e}`,{taskId:e});return i}async failTask(e,t){let i=this.store.getTask(e);if(!i)throw new g("TASK_NOT_FOUND",`Task not found: ${e}`,{taskId:e});let n=this.store.updateTask(e,{status:"failed",updatedAt:v(),metadata:{...i.metadata,failureReason:t}});if(!n)throw new g("TASK_NOT_FOUND",`Failed to update task: ${e}`,{taskId:e});return n}getTasks(e){return e?this.store.queryTasks(t=>t.status===e):this.store.getTasks()}validateCreateInput(e){if(!e.description||""===e.description.trim())throw new g("VALIDATION_ERROR","Task description is required",{field:"description"});if(!e.agentId||""===e.agentId.trim())throw new g("VALIDATION_ERROR","Agent ID is required",{field:"agentId"});if(!e.requiredEvidence||0===e.requiredEvidence.length)throw new g("VALIDATION_ERROR","At least one required evidence type must be specified",{field:"requiredEvidence"})}findMissingEvidence(e,t){return e.filter(e=>null==t[e])}},C=class{constructor(e,t){this.config=e,this.store=t}async export(e){let t;let i=this.filterActions(e),n=this.filterTransactions(e),r=e.includeTasks?this.filterTasks(e):[],s=e.includeAnomalies?this.filterAnomalies(e):[],a={actions:i,transactions:n,tasks:r,anomalies:s,exportMetadata:{projectId:this.config.projectId,exportedAt:v(),filters:{dateRange:e.dateRange?{start:e.dateRange.start.toISOString(),end:e.dateRange.end.toISOString()}:null,agentIds:e.agentIds??null,types:e.types??null,chains:e.chains??null}}},o=i.length+n.length+r.length+s.length;return t="csv"===e.format?this.formatAsCsv(i,n,r,s):JSON.stringify(a,null,2),{format:e.format,exportedAt:v(),recordCount:o,data:t}}async generateReport(e){let t={format:"json",dateRange:e.period,agentIds:e.agentIds,includeTasks:!0,includeAnomalies:!0},i=this.filterActions(t),n=this.filterTransactions(t),r=this.filterTasks(t),s=this.filterAnomalies(t),a=r.filter(e=>"confirmed"===e.status).length,o=r.filter(e=>"failed"===e.status).length,l=r.length>0?a/r.length:1,c=i.length>0?1-s.length/i.length:1;return{id:y(),type:e.type,generatedAt:v(),period:e.period,projectId:this.config.projectId,summary:{totalActions:i.length,totalTransactions:n.length,totalTasks:r.length,confirmedTasks:a,failedTasks:o,totalAnomalies:s.length,averageTrustScore:Math.round((50*l+50*c)*100)/100},actions:i,transactions:n,tasks:r,anomalies:s}}async generateSARReport(e){let t={format:"json",dateRange:e.period,agentIds:e.agentIds,includeTasks:!0,includeAnomalies:!0},i=this.filterActions(t),n=this.filterTransactions(t),r=this.filterAnomalies(t),s=new Set(r.map(e=>e.actionId)),a=n.filter(e=>s.has(e.id)),o=new Set(r.map(e=>e.agentId)),l=0===a.length?n.filter(e=>o.has(e.agentId)):[],c=[...a,...l],d=new Map;for(let e of c)if(!d.has(e.agentId)){let t=n.filter(t=>t.agentId===e.agentId),i=new Set;for(let e of t)i.add(e.from),i.add(e.to);d.set(e.agentId,{name:e.agentId,agentId:e.agentId,addresses:Array.from(i)})}let u=c.reduce((e,t)=>e+(k(t.amount)||0),0).toFixed(2),h=new Map;for(let e of c)h.set(e.token,(h.get(e.token)??0)+1);let g=h.size>0?Array.from(h.entries()).sort((e,t)=>t[1]-e[1])[0][0]:"USDC",p=Array.from(new Set(r.map(e=>this.anomalyTypeToCategory(e.type)))),m=this.generateSARNarrative(c,r,e.period);return{id:y(),type:"sar",generatedAt:v(),period:e.period,projectId:this.config.projectId,filingInstitution:this.config.projectId,subjects:Array.from(d.values()),narrative:m,activityCategories:p,totalAmount:u,currency:g,suspiciousTransactions:c,anomalies:r,supportingActions:i.filter(e=>o.has(e.agentId)),isContinuingActivity:!1,priorReportId:null,status:"draft"}}async generateCTRReport(e){let t={format:"json",dateRange:e.period,agentIds:e.agentIds,includeTasks:!1,includeAnomalies:!1},i=this.filterActions(t),n=this.filterTransactions(t),r=n.filter(e=>{let t=k(e.amount);return!isNaN(t)&&t>=1e4}),s=new Map;for(let e of n){let t=e.timestamp.split("T")[0],i=`${e.agentId}:${t}`;s.set(i,(s.get(i)??0)+(k(e.amount)||0))}let a=new Set;for(let[e,t]of s.entries())t>=1e4&&a.add(e);let o=new Set(r.map(e=>e.id)),l=n.filter(e=>{if(o.has(e.id))return!1;let t=e.timestamp.split("T")[0],i=`${e.agentId}:${t}`;return a.has(i)}),c=[...r,...l],d=l.length>0,u=new Map;for(let e of c)if(!u.has(e.agentId)){let t=c.filter(t=>t.agentId===e.agentId),i=new Set;for(let e of t)i.add(e.from),i.add(e.to);u.set(e.agentId,{name:e.agentId,agentId:e.agentId,addresses:Array.from(i)})}let h=0,g=0;for(let e of c){let t=k(e.amount)||0;g+=t,h+=t}let p=Array.from(new Set(c.map(e=>e.chain))),m=new Map;for(let e of c)m.set(e.token,(m.get(e.token)??0)+1);let f=m.size>0?Array.from(m.entries()).sort((e,t)=>t[1]-e[1])[0][0]:"USDC";return{id:y(),type:"ctr",generatedAt:v(),period:e.period,projectId:this.config.projectId,filingInstitution:this.config.projectId,conductors:Array.from(u.values()),transactions:c,totalCashIn:h.toFixed(2),totalCashOut:g.toFixed(2),currency:f,isAggregated:d,chainsInvolved:p,supportingActions:i.filter(e=>u.has(e.agentId)),status:"draft"}}anomalyTypeToCategory(e){return({unusualAmount:"Unusual transaction amount",frequencySpike:"Unusually high transaction frequency",newDestination:"Transactions to unknown destinations",offHoursActivity:"Activity during unusual hours",rapidSuccession:"Rapid succession of transactions",roundAmount:"Potential structuring (round amounts)"})[e]??`Other: ${e}`}generateSARNarrative(e,t,i){let n=i.start.toISOString().split("T")[0],r=i.end.toISOString().split("T")[0],s=[];if(s.push(`During the period from ${n} to ${r}, ${e.length} transaction(s) were identified as potentially suspicious.`),t.length>0){let e=new Map;for(let i of t)e.set(i.type,(e.get(i.type)??0)+1);let i=Array.from(e.entries()).map(([e,t])=>`${this.anomalyTypeToCategory(e)} (${t} occurrence(s))`).join("; ");s.push(`Anomaly detection identified the following patterns: ${i}.`)}let a=e.reduce((e,t)=>e+(k(t.amount)||0),0).toFixed(2);s.push(`Total amount involved: ${a}.`);let o=new Set(e.map(e=>e.agentId));return s.push(`Agent(s) involved: ${Array.from(o).join(", ")}.`),s.push("This report is generated as a template for review. Additional investigation and supporting documentation should be attached before filing."),s.join(" ")}filterActions(e){return this.store.queryActions(t=>(!e.dateRange||!!A(t.timestamp,e.dateRange.start,e.dateRange.end))&&(!e.agentIds||!!e.agentIds.includes(t.agentId))&&(!e.types||!!e.types.includes(t.type)))}filterTransactions(e){return this.store.queryTransactions(t=>(!e.dateRange||!!A(t.timestamp,e.dateRange.start,e.dateRange.end))&&(!e.agentIds||!!e.agentIds.includes(t.agentId))&&(!e.chains||!!e.chains.includes(t.chain)))}filterTasks(e){return this.store.queryTasks(t=>(!e.dateRange||!!A(t.createdAt,e.dateRange.start,e.dateRange.end))&&(!e.agentIds||!!e.agentIds.includes(t.agentId)))}filterAnomalies(e){return this.store.queryAnomalies(t=>(!e.dateRange||!!A(t.detectedAt,e.dateRange.start,e.dateRange.end))&&(!e.agentIds||!!e.agentIds.includes(t.agentId)))}formatAsCsv(e,t,i,n){let r=[];if(e.length>0){let t=e.map(e=>({section:"action",id:e.id,timestamp:e.timestamp,projectId:e.projectId,agentId:e.agentId,correlationId:e.correlationId,type:e.type,description:e.description,metadata:JSON.stringify(e.metadata)}));r.push("# Actions\n"+I(t))}if(t.length>0){let e=t.map(e=>({section:"transaction",id:e.id,timestamp:e.timestamp,txHash:e.txHash,chain:e.chain,amount:e.amount,token:e.token,from:e.from,to:e.to,agentId:e.agentId}));r.push("# Transactions\n"+I(e))}if(i.length>0){let e=i.map(e=>({section:"task",id:e.id,description:e.description,agentId:e.agentId,status:e.status,createdAt:e.createdAt,confirmedAt:e.confirmedAt??"",requiredEvidence:e.requiredEvidence.join(";")}));r.push("# Tasks\n"+I(e))}if(n.length>0){let e=n.map(e=>({section:"anomaly",id:e.id,type:e.type,severity:e.severity,description:e.description,agentId:e.agentId,detectedAt:e.detectedAt,reviewed:String(e.reviewed)}));r.push("# Anomalies\n"+I(e))}return r.join("\n\n")}},D=class{constructor(e,t){this.config=e,this.store=t}async getTrustScore(e){let t=this.computeAgentFactors(e),i=t.reduce((e,t)=>e+t.score*t.weight,0),n=t.reduce((e,t)=>e+t.weight,0),r=T(n>0?Math.round(i/n):50,0,100);return{agentId:e,score:r,factors:t,computedAt:v(),level:this.scoreToLevel(r)}}async evaluateTransaction(e){let t=this.computeTransactionRiskFactors(e),i=T(Math.round(t.reduce((e,t)=>e+t.score,0)/Math.max(t.length,1)),0,100),n=this.riskScoreToLevel(i),r=i>=60,s=i>=80?"block":i>=50?"review":"approve";return{txHash:e.txHash,riskScore:i,riskLevel:n,factors:t,flagged:r,recommendation:s,evaluatedAt:v()}}computeAgentFactors(e){let t=[];return t.push(this.computeHistoryDepthFactor(e)),t.push(this.computeTaskCompletionFactor(e)),t.push(this.computeAnomalyFrequencyFactor(e)),t.push(this.computeTransactionConsistencyFactor(e)),t.push(this.computeComplianceAdherenceFactor(e)),t}computeHistoryDepthFactor(e){let t=this.store.getActionsByAgent(e).length;return{name:"history_depth",score:0===t?10:t<5?30:t<20?50:t<50?70:t<100?85:95,weight:.15,description:`Agent has ${t} recorded actions`}}computeTaskCompletionFactor(e){let t=this.store.queryTasks(t=>t.agentId===e),i=t.length;if(0===i)return{name:"task_completion",score:50,weight:.25,description:"No tasks recorded yet"};let n=t.filter(e=>"confirmed"===e.status).length,r=t.filter(e=>"failed"===e.status).length,s=n/i;return{name:"task_completion",score:T(Math.round(100*s-r/i*30),0,100),weight:.25,description:`${n}/${i} tasks confirmed (${Math.round(100*s)}% rate)`}}computeAnomalyFrequencyFactor(e){let t=this.store.queryAnomalies(t=>t.agentId===e),i=this.store.getActionsByAgent(e),n=t.length,r=i.length;if(0===r)return{name:"anomaly_frequency",score:50,weight:.25,description:"No actions recorded yet"};let s=n/r;return{name:"anomaly_frequency",score:T((0===s?100:s<.01?90:s<.05?70:s<.1?50:s<.25?30:10)-(15*t.filter(e=>"critical"===e.severity).length+8*t.filter(e=>"high"===e.severity).length),0,100),weight:.25,description:`${n} anomalies across ${r} actions (${Math.round(100*s)}% rate)`}}computeTransactionConsistencyFactor(e){let t;let i=this.store.getTransactionsByAgent(e);if(i.length<2)return{name:"transaction_consistency",score:50,weight:.2,description:"Insufficient transaction history for consistency analysis"};let n=i.map(e=>k(e.amount)).filter(e=>!isNaN(e));if(n.length<2)return{name:"transaction_consistency",score:50,weight:.2,description:"Insufficient valid amounts for consistency analysis"};let r=n.reduce((e,t)=>e+t,0)/n.length,s=n.reduce((e,t)=>e+Math.pow(t-r,2),0)/n.length,a=r>0?Math.sqrt(s)/r:0;t=a<.1?95:a<.3?80:a<.5?65:a<1?45:a<2?30:15;let o=new Set(i.map(e=>e.to));return o.size/i.length>.8&&i.length>5&&(t=Math.max(t-15,0)),{name:"transaction_consistency",score:T(t,0,100),weight:.2,description:`CV=${a.toFixed(2)}, ${o.size} unique destinations across ${i.length} transactions`}}computeComplianceAdherenceFactor(e){let t=this.store.queryTasks(t=>t.agentId===e),i=this.store.getTransactionsByAgent(e),n=t.filter(e=>"confirmed"===e.status),r=n.filter(e=>null!==e.providedEvidence&&Object.keys(e.providedEvidence).length>0),s=50;return n.length>0&&(s+=Math.round(r.length/n.length*30)),i.length>0&&t.length>0&&(s+=Math.round(20*Math.min(t.length/i.length,1))),{name:"compliance_adherence",score:T(s,0,100),weight:.15,description:`${r.length} tasks with evidence, ${i.length} total transactions`}}computeTransactionRiskFactors(e){let t=[];return t.push(this.computeAmountRisk(e)),t.push(this.computeNewDestinationRisk(e)),t.push(this.computeFrequencyRisk(e)),t.push(this.computeAgentRisk(e.agentId)),t.push(this.computeRoundAmountRisk(e)),t}computeAmountRisk(e){let t;let i=k(e.amount);if(isNaN(i))return{name:"amount_risk",score:50,description:"Unable to parse transaction amount"};t=i<100?5:i<1e3?15:i<1e4?30:i<5e4?55:i<1e5?75:95;let n=this.store.getTransactionsByAgent(e.agentId);if(n.length>0){let e=n.reduce((e,t)=>e+k(t.amount),0)/n.length;e>0&&i>5*e&&(t=Math.min(t+20,100))}return{name:"amount_risk",score:t,description:`Transaction amount ${e.amount} ${e.token}`}}computeNewDestinationRisk(e){let t=this.store.getTransactionsByAgent(e.agentId),i=!new Set(t.map(e=>e.to.toLowerCase())).has(e.to.toLowerCase());return 0===t.length?{name:"new_destination",score:30,description:"First transaction for this agent -- no destination history"}:{name:"new_destination",score:i?45:5,description:i?`New destination address: ${e.to}`:`Known destination address: ${e.to}`}}computeFrequencyRisk(e){let t=new Date(Date.now()-36e5),i=this.store.queryTransactions(i=>i.agentId===e.agentId&&new Date(i.timestamp)>=t).length;return{name:"frequency_risk",score:i<5?5:i<10?20:i<25?45:i<50?70:90,description:`${i} transactions in the last hour`}}computeAgentRisk(e){let t=this.store.getActionsByAgent(e),i=this.store.queryAnomalies(t=>t.agentId===e);if(0===t.length)return{name:"agent_reputation",score:40,description:"New agent with no history"};let n=i.length/t.length;return{name:"agent_reputation",score:T(Math.round(100*n),0,100),description:`Agent anomaly rate: ${Math.round(100*n)}%`}}computeRoundAmountRisk(e){let t=k(e.amount);if(isNaN(t))return{name:"round_amount",score:10,description:"Unable to parse amount"};let i=t>=1e3&&t%1e3==0,n=5;return t>=1e4&&t%1e4==0?n=25:i&&(n=15),t>=9e3&&t<=1e4&&(n+=20),{name:"round_amount",score:n,description:`Amount ${e.amount} -- ${i?"round amount":"non-round amount"}`}}scoreToLevel(e){return e>=90?"verified":e>=70?"high":e>=50?"medium":e>=30?"low":"untrusted"}riskScoreToLevel(e){return e>=80?"critical":e>=60?"high":e>=35?"medium":"low"}},_={maxAmount:"10000",maxFrequency:30,offHours:[22,23,0,1,2,3,4,5],minIntervalSeconds:10},O=class{constructor(e,t){this.detectionConfig=null,this.thresholds={..._},this.callbacks=[],this.enabled=!1,this.config=e,this.store=t}enableAnomalyDetection(e){if(!e.rules||0===e.rules.length)throw new g("ANOMALY_CONFIG_ERROR","At least one detection rule must be specified");this.detectionConfig=e,this.thresholds={..._,...e.thresholds},this.enabled=!0,this.config.debug&&console.debug(`[Kontext] Anomaly detection enabled with rules: ${e.rules.join(", ")}`)}disableAnomalyDetection(){this.enabled=!1,this.detectionConfig=null,this.config.debug&&console.debug("[Kontext] Anomaly detection disabled")}onAnomaly(e){return this.callbacks.push(e),()=>{let t=this.callbacks.indexOf(e);-1!==t&&this.callbacks.splice(t,1)}}evaluateTransaction(e){if(!this.enabled||!this.detectionConfig)return[];let t=[];for(let i of this.detectionConfig.rules){let n=this.runRule(i,e);n&&(t.push(n),this.store.addAnomaly(n),this.notifyCallbacks(n))}return t}evaluateAction(e){if(!this.enabled||!this.detectionConfig)return[];let t=[],i=["offHoursActivity","frequencySpike"];for(let n of this.detectionConfig.rules){if(!i.includes(n))continue;let r=this.runActionRule(n,e);r&&(t.push(r),this.store.addAnomaly(r),this.notifyCallbacks(r))}return t}isEnabled(){return this.enabled}getConfig(){return this.detectionConfig}runRule(e,t){switch(e){case"unusualAmount":return this.checkUnusualAmount(t);case"frequencySpike":return this.checkFrequencySpike(t);case"newDestination":return this.checkNewDestination(t);case"offHoursActivity":return this.checkOffHours(t);case"rapidSuccession":return this.checkRapidSuccession(t);case"roundAmount":return this.checkRoundAmount(t);default:return null}}runActionRule(e,t){switch(e){case"offHoursActivity":return this.checkOffHoursAction(t);case"frequencySpike":return this.checkActionFrequencySpike(t);default:return null}}checkUnusualAmount(e){let t=k(e.amount);if(isNaN(t))return null;let i=k(this.thresholds.maxAmount);if(t>i)return this.createAnomaly("unusualAmount",t>5*i?"critical":t>2*i?"high":"medium",`Transaction amount ${e.amount} ${e.token} exceeds threshold of ${this.thresholds.maxAmount}`,e.agentId,e.id,{amount:e.amount,threshold:this.thresholds.maxAmount,token:e.token});let n=this.store.getTransactionsByAgent(e.agentId);if(n.length>=3){let i=n.map(e=>k(e.amount)).filter(e=>!isNaN(e));if(i.length>=3){let n=i.reduce((e,t)=>e+t,0)/i.length;if(n>0&&t>5*n)return this.createAnomaly("unusualAmount",t>10*n?"high":"medium",`Transaction amount ${e.amount} is ${(t/n).toFixed(1)}x the agent's average of ${n.toFixed(2)}`,e.agentId,e.id,{amount:e.amount,average:n.toFixed(2),multiplier:(t/n).toFixed(1)})}}return null}checkFrequencySpike(e){let t=new Date(Date.now()-36e5),i=this.store.queryTransactions(i=>i.agentId===e.agentId&&new Date(i.timestamp)>=t).length,n=this.thresholds.maxFrequency;return i>n?this.createAnomaly("frequencySpike",i>3*n?"critical":i>2*n?"high":"medium",`Agent ${e.agentId} has ${i} transactions in the last hour (threshold: ${n})`,e.agentId,e.id,{count:i,threshold:n}):null}checkNewDestination(e){let t=this.store.getTransactionsByAgent(e.agentId);if(t.length<3)return null;let i=new Set(t.filter(t=>t.id!==e.id).map(e=>e.to.toLowerCase()));if(!i.has(e.to.toLowerCase())){let t=k(e.amount),n=!isNaN(t)&&t>.5*k(this.thresholds.maxAmount)?"high":"low";return this.createAnomaly("newDestination",n,`Transaction to new destination ${e.to} (agent has ${i.size} known destinations)`,e.agentId,e.id,{destination:e.to,knownDestinationCount:i.size})}return null}checkOffHours(e){let t=new Date(e.timestamp).getUTCHours();return this.thresholds.offHours.includes(t)?this.createAnomaly("offHoursActivity","low",`Transaction at ${t}:00 UTC falls within off-hours window`,e.agentId,e.id,{hour:t,offHours:this.thresholds.offHours}):null}checkRapidSuccession(e){let t=this.store.getTransactionsByAgent(e.agentId).filter(t=>t.id!==e.id);if(0===t.length)return null;let i=t[t.length-1];if(!i)return null;let n=(new Date(e.timestamp).getTime()-new Date(i.timestamp).getTime())/1e3;return n>=0&&n<this.thresholds.minIntervalSeconds?this.createAnomaly("rapidSuccession",n<2?"high":"medium",`Transaction occurred ${n.toFixed(1)}s after previous transaction (minimum: ${this.thresholds.minIntervalSeconds}s)`,e.agentId,e.id,{intervalSeconds:n,threshold:this.thresholds.minIntervalSeconds,previousTxId:i.id}):null}checkRoundAmount(e){let t=k(e.amount);if(isNaN(t))return null;for(let i of[1e4,5e3,3e3,1e3]){let n=i-t;if(n>0&&n<=.05*i)return this.createAnomaly("roundAmount",i>=1e4?"high":"medium",`Transaction amount ${e.amount} is just below the ${i} threshold (potential structuring)`,e.agentId,e.id,{amount:e.amount,nearThreshold:i,difference:n})}return t>=5e3&&t%1e3==0?this.createAnomaly("roundAmount","low",`Transaction amount ${e.amount} is a round number`,e.agentId,e.id,{amount:e.amount}):null}checkOffHoursAction(e){let t=new Date(e.timestamp).getUTCHours();return this.thresholds.offHours.includes(t)?this.createAnomaly("offHoursActivity","low",`Action at ${t}:00 UTC falls within off-hours window`,e.agentId,e.id,{hour:t,offHours:this.thresholds.offHours}):null}checkActionFrequencySpike(e){let t=new Date(Date.now()-36e5),i=this.store.queryActions(i=>i.agentId===e.agentId&&new Date(i.timestamp)>=t).length,n=3*this.thresholds.maxFrequency;return i>n?this.createAnomaly("frequencySpike",i>2*n?"high":"medium",`Agent ${e.agentId} has ${i} actions in the last hour (threshold: ${n})`,e.agentId,e.id,{count:i,threshold:n}):null}createAnomaly(e,t,i,n,r,s){return{id:y(),type:e,severity:t,description:i,agentId:n,actionId:r,detectedAt:v(),data:s,reviewed:!1}}notifyCallbacks(e){for(let t of this.callbacks)try{t(e)}catch(e){this.config.debug&&console.debug("[Kontext] Anomaly callback error:",e)}}},E={ethereum:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",base:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",polygon:"0x3c499c542cEF5E3811e1192ce70d8cC03d5c3359",arbitrum:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",optimism:"0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85",arc:"0xa0c0000000000000000000000000000000000001"},N=["0xd90e2f925DA726b50C4Ed8D0Fb90Ad053324F31b","0xd96f2B1c14Db8458374d9Aca76E26c3D18364307","0x4736dCf1b7A3d580672CcE6E7c65cd5cc9cFBfA9","0xDD4c48C0B24039969fC16D1cdF626eaB821d3384","0xd4B88Df4D29F5CedD6857912842cff3b20C8Cfa3","0x910Cbd523D972eb0a6f4cAe4618aD62622b39DbF","0xA160cdAB225685dA1d56aa342Ad8841c3b53f291","0xFD8610d20aA15b7B2E3Be39B396a1bC3516c7144","0xF60dD140cFf0706bAE9Cd734Ac3683731B816EeD","0x22aaA7720ddd5388A3c0A3333430953C68f1849b","0xBA214C1c1928a32Bffe790263E38B4Af9bFCD659","0xb1C8094B234DcE6e03f10a5b673c1d8C69739A00","0x527653eA119F3E6a1F5BD18fbF4714081D7B31ce","0x58E8dCC13BE9780fC42E8723D8EaD4CF46943dF2","0x8589427373D6D84E98730D7795D8f6f8731FDA16","0x722122dF12D4e14e13Ac3b6895a86e84145b6967","0x098B716B8Aaf21512996dC57EB0615e2383E2f96","0xa0e1c89Ef1a489c9C7dE96311eD5Ce5D32c20E4B","0x3Cffd56B47B7b41c56258D9C7731ABaDc360E460","0x53b6936513e738f44FB50d2b9476730C0Ab3Bfc1","0x6F1cA141A28907F78Ebaa64f83E4AE6038d3cbe7","0x23773E65ed146A459791799d01336DB287f25334"],P=new Set(N.map(e=>e.toLowerCase())),$=class e{static checkTransaction(t){let i=[];i.push(e.checkTokenType(t)),i.push(e.checkChainSupport(t.chain)),i.push(e.checkAddressFormat(t.from,"sender")),i.push(e.checkAddressFormat(t.to,"recipient")),i.push(e.checkAmountValid(t.amount)),i.push(e.checkSanctions(t.from,"sender")),i.push(e.checkSanctions(t.to,"recipient")),i.push(e.checkEnhancedDueDiligence(t.amount)),i.push(e.checkReportingThreshold(t.amount));let n=i.filter(e=>!e.passed),r=n.every(e=>"low"===e.severity),s=n.reduce((e,t)=>{let i=["low","medium","high","critical"];return i.indexOf(t.severity)>i.indexOf(e)?t.severity:e},"low"),a=e.generateRecommendations(i,t);return{compliant:r,checks:i,riskLevel:s,recommendations:a}}static isSanctioned(e){return P.has(e.toLowerCase())}static checkSanctionsDetailed(e){let t=e.toLowerCase(),i=P.has(t),n=null;return i&&(n=N.find(e=>e.toLowerCase()===t)??null),{sanctioned:i,address:e,listMatch:i?"OFAC_SDN":null,matchedAddress:n}}static getSanctionedAddresses(){return[...N]}static getContractAddress(e){return E[e]}static getSupportedChains(){return Object.keys(E)}static checkTokenType(e){let t="USDC"===e.token;return{name:"token_type",passed:t,description:t?"Transaction token is USDC":`Expected USDC but got ${e.token}`,severity:t?"low":"high"}}static checkChainSupport(e){let t=e in E;return{name:"chain_support",passed:t,description:t?`Chain ${e} is supported for USDC compliance monitoring`:`Chain ${e} is not in the supported USDC compliance list`,severity:t?"low":"medium"}}static checkAddressFormat(e,t){let i=/^0x[a-fA-F0-9]{40}$/.test(e);return{name:`address_format_${t}`,passed:i,description:i?`${t} address format is valid`:`${t} address format is invalid: ${e}`,severity:i?"low":"high"}}static checkAmountValid(e){let t=k(e),i=!isNaN(t)&&t>0;return{name:"amount_valid",passed:i,description:i?`Transaction amount ${e} is valid`:`Transaction amount ${e} is invalid`,severity:i?"low":"critical"}}static checkSanctions(t,i){let n=e.checkSanctionsDetailed(t);return n.sanctioned&&console.warn(`[Kontext] SANCTIONS WARNING: ${i} address ${t} matches ${n.listMatch} sanctioned address ${n.matchedAddress}`),{name:`sanctions_${i}`,passed:!n.sanctioned,description:n.sanctioned?`${i} address ${t} matches ${n.listMatch} sanctioned address`:`${i} address passed sanctions screening`,severity:n.sanctioned?"critical":"low"}}static checkEnhancedDueDiligence(e){let t=k(e),i=!isNaN(t)&&t>=3e3;return{name:"enhanced_due_diligence",passed:!0,description:i?`Amount ${e} USDC requires enhanced due diligence (threshold: 3000)`:`Amount ${e} USDC is below enhanced due diligence threshold`,severity:i?"medium":"low"}}static checkReportingThreshold(e){let t,i;let n=k(e),r=!isNaN(n)&&n>=1e4;return!isNaN(n)&&n>=5e4?(t=`Amount ${e} USDC is a large transaction (>= 50000) -- requires enhanced monitoring`,i="high"):r?(t=`Amount ${e} USDC meets reporting threshold (>= 10000)`,i="medium"):(t=`Amount ${e} USDC is below reporting threshold`,i="low"),{name:"reporting_threshold",passed:!0,description:t,severity:i}}static generateRecommendations(e,t){let i=[],n=k(t.amount);return e.filter(e=>!e.passed&&"critical"===e.severity).length>0&&i.push("BLOCK: Critical compliance check failures detected. Do not proceed."),e.filter(e=>e.name.startsWith("sanctions_")&&!e.passed).length>0&&i.push("BLOCK: Address matches OFAC SDN sanctioned entity. Transaction is prohibited under U.S. law."),!isNaN(n)&&(n>=5e4?(i.push("Require manual review for large transaction per GENIUS Act Section 4(b)."),i.push("Verify recipient identity through KYC process."),i.push("Document business purpose for the transfer.")):n>=1e4?(i.push("Generate Currency Transaction Report (CTR) per BSA requirements."),i.push("Retain transaction records for minimum 5 years.")):n>=3e3&&i.push("Enhanced due diligence recommended -- verify transaction purpose.")),e.filter(e=>e.name.startsWith("address_format")&&!e.passed).length>0&&i.push("Verify address format before proceeding."),0===i.length&&i.push("Transaction passes all compliance checks. Safe to proceed."),i}},j=class e{constructor(e){this.config=e,this.mode=e.apiKey?"cloud":"local",this.store=new m,e.storage&&this.store.setStorageAdapter(e.storage),this.logger=new R(e,this.store),this.taskManager=new S(e,this.store),this.auditExporter=new C(e,this.store),this.trustScorer=new D(e,this.store),this.anomalyDetector=new O(e,this.store)}static init(t){if(!t.projectId||""===t.projectId.trim())throw new g("INITIALIZATION_ERROR","projectId is required");let i=["development","staging","production"];if(!i.includes(t.environment))throw new g("INITIALIZATION_ERROR",`Invalid environment: ${t.environment}. Must be one of: ${i.join(", ")}`);if(t.debug){let e=t.apiKey?"cloud":"local";console.debug(`[Kontext] Initializing in ${e} mode for project ${t.projectId} (${t.environment})`)}return new e(t)}getMode(){return this.mode}getConfig(){return{...this.config,apiKey:this.config.apiKey?`${this.config.apiKey.slice(0,8)}...`:void 0}}async log(e){let t=await this.logger.log(e);return this.anomalyDetector.isEnabled()&&this.anomalyDetector.evaluateAction(t),t}async logTransaction(e){let t=await this.logger.logTransaction(e);return this.anomalyDetector.isEnabled()&&this.anomalyDetector.evaluateTransaction(t),t}async flushLogs(){await this.logger.flush()}async flush(){await this.logger.flush(),await this.store.flush()}async restore(){await this.store.restore()}async createTask(e){return this.taskManager.createTask(e)}async confirmTask(e){return this.taskManager.confirmTask(e)}async getTaskStatus(e){return this.taskManager.getTaskStatus(e)}async startTask(e){return this.taskManager.startTask(e)}async failTask(e,t){return this.taskManager.failTask(e,t)}getTasks(e){return this.taskManager.getTasks(e)}async export(e){return this.auditExporter.export(e)}async generateReport(e){return this.auditExporter.generateReport(e)}async generateSARReport(e){return this.auditExporter.generateSARReport(e)}async generateCTRReport(e){return this.auditExporter.generateCTRReport(e)}async getTrustScore(e){return this.trustScorer.getTrustScore(e)}async evaluateTransaction(e){return this.trustScorer.evaluateTransaction(e)}enableAnomalyDetection(e){this.anomalyDetector.enableAnomalyDetection(e)}disableAnomalyDetection(){this.anomalyDetector.disableAnomalyDetection()}onAnomaly(e){return this.anomalyDetector.onAnomaly(e)}getTerminalDigest(){return this.logger.getTerminalDigest()}verifyDigestChain(){let e=this.store.getActions();return this.logger.verifyChain(e)}exportDigestChain(){return this.logger.getDigestChain().exportChain()}getActions(){return this.store.getActions()}checkUsdcCompliance(e){return $.checkTransaction(e)}async logReasoning(e){if(!e.agentId||""===e.agentId.trim())throw new g("VALIDATION_ERROR","agentId is required for reasoning entries");if(!e.action||""===e.action.trim())throw new g("VALIDATION_ERROR","action is required for reasoning entries");if(!e.reasoning||""===e.reasoning.trim())throw new g("VALIDATION_ERROR","reasoning is required for reasoning entries");if(void 0!==e.confidence&&(e.confidence<0||e.confidence>1))throw new g("VALIDATION_ERROR","confidence must be between 0 and 1");let t={id:y(),timestamp:v(),agentId:e.agentId,action:e.action,reasoning:e.reasoning,confidence:e.confidence??1,context:e.context??{}};return await this.log({type:"reasoning",description:`Reasoning for ${e.action}: ${e.reasoning}`,agentId:e.agentId,metadata:{reasoningId:t.id,action:e.action,reasoning:e.reasoning,confidence:t.confidence,context:t.context}}),t}getReasoningEntries(e){return this.store.queryActions(t=>t.agentId===e&&"reasoning"===t.type).map(e=>({id:e.metadata.reasoningId,timestamp:e.timestamp,agentId:e.agentId,action:e.metadata.action,reasoning:e.metadata.reasoning,confidence:e.metadata.confidence,context:e.metadata.context??{}}))}async generateComplianceCertificate(e){let t;let{agentId:i,timeRange:n,includeReasoning:r}=e,s=this.store.getActionsByAgent(i);if(n){let e=n.from.getTime(),t=n.to.getTime();s=s.filter(i=>{let n=new Date(i.timestamp).getTime();return n>=e&&n<=t})}let a=s.filter(e=>"transaction"===e.type),o=s.filter(e=>"tool_call"===e.type),l=s.filter(e=>"reasoning"===e.type),d=new Map;for(let e of s)d.set(e.type,(d.get(e.type)??0)+1);let u=Array.from(d.entries()).map(([e,t])=>({type:e,count:t})),h=this.verifyDigestChain(),g=this.logger.getDigestChain().getChainLength(),p=this.getTerminalDigest(),m=await this.trustScorer.getTrustScore(i),f=this.store.queryAnomalies(e=>e.agentId===i),b=f;if(n){let e=n.from.getTime(),t=n.to.getTime();b=f.filter(i=>{let n=new Date(i.detectedAt).getTime();return n>=e&&n<=t})}let w=b.filter(e=>"critical"===e.severity),A=b.filter(e=>"high"===e.severity);t=!h.valid||w.length>0?"non-compliant":A.length>0||m.score<50?"review-required":"compliant";let k=[];r&&(k=l.map(e=>({id:e.metadata.reasoningId,timestamp:e.timestamp,agentId:e.agentId,action:e.metadata.action,reasoning:e.metadata.reasoning,confidence:e.metadata.confidence,context:e.metadata.context??{}})));let x={certificateId:y(),agentId:i,issuedAt:v(),summary:{actions:s.length,transactions:a.length,toolCalls:o.length,reasoningEntries:l.length},digestChain:{terminalDigest:p,chainLength:g,verified:h.valid},trustScore:m.score,complianceStatus:t,actions:u,reasoning:k},I=(0,c.createHash)("sha256");I.update(JSON.stringify(x));let T=I.digest("hex");return{...x,signature:T}}async destroy(){await this.logger.destroy()}},q={ethereum:"ETH",base:"ETH",polygon:"MATIC",arbitrum:"ETH",optimism:"ETH",arc:"ARC"},L={ethereum:"0.005",base:"0.0001",polygon:"0.01",arbitrum:"0.0003",optimism:"0.0002",arc:"0.0001"};let F=null;function M(){return F||(F=j.init({projectId:"kontext-demo",environment:"development"})).enableAnomalyDetection({rules:["unusualAmount","frequencySpike","newDestination","roundAmount"],thresholds:{maxAmount:"50000",maxFrequency:20}}),F}function U(){let e="0123456789abcdef",t="0x";for(let i=0;i<64;i++)t+=e[Math.floor(Math.random()*e.length)];return t}async function H(e){try{let{message:t}=await e.json();if(!t||"string"!=typeof t)return l.NextResponse.json({error:"message is required"},{status:400});let i=M(),n="demo-agent";await i.log({type:"ai_generate",description:`User prompt: ${t.slice(0,100)}`,agentId:n,metadata:{prompt:t,source:"demo-chat"}});let r=function(e){let t=e.toLowerCase(),i=t.match(/(?:send|transfer|pay)\s+\$?([\d,]+(?:\.\d+)?)\s*(?:usdc|usd)?\s*(?:to\s+)?(0x[a-f0-9]+)?/i);if(i){let e=i[1].replace(/,/g,""),t=i[2]||"0x742d35Cc6634C0532925a3b844Bc9e7595bBD1E",n=U();return{message:`I've initiated a transfer of ${e} USDC to \`${t.slice(0,6)}...${t.slice(-4)}\` on Base.

Transaction hash: \`${n.slice(0,10)}...${n.slice(-6)}\`

The transfer has been logged to the Kontext audit trail with a SHA-256 digest for tamper-evident compliance.`,toolCalls:[{name:"transfer_usdc",args:{amount:e,to:t,chain:"base",token:"USDC"},result:{success:!0,txHash:n,chain:"base",amount:e,to:t,gasUsed:"21000",blockNumber:18942156+Math.floor(1e3*Math.random())}}]}}if(t.includes("balance")||t.includes("how much")||t.includes("wallet")){let e=(5e4*Math.random()+5e3).toFixed(2);return{message:`Your wallet balance on Base:

- **USDC**: ${e}
- **ETH**: ${(2*Math.random()+.1).toFixed(4)}

All balance queries are recorded in the Kontext audit trail.`,toolCalls:[{name:"check_balance",args:{chain:"base",address:"0x1234567890abcdef1234567890abcdef12345678"},result:{balances:{USDC:e,ETH:(2*Math.random()+.1).toFixed(4)},chain:"base"}}]}}return t.includes("trust")||t.includes("score")?{message:"I'll fetch the current trust score from Kontext. The trust score is computed from multiple factors including history depth, task completion rate, anomaly frequency, transaction consistency, and compliance adherence.",toolCalls:[]}:t.includes("compliance")||t.includes("compliant")?{message:"Kontext automatically runs compliance checks on every financial operation. This includes OFAC sanctions screening, amount threshold checks (EDD at $3,000, CTR at $10,000), address format validation, and chain support verification. All checks are logged to the tamper-evident digest chain.",toolCalls:[]}:t.includes("digest")||t.includes("audit")||t.includes("chain")?{message:"The Kontext digest chain uses rolling SHA-256 hashes where each event's digest incorporates the prior digest: `H(n) = SHA-256(H(n-1) || Serialize(E) || Salt)`. This creates a tamper-evident audit trail -- modifying any past event breaks the chain. You can verify this independently by exporting the chain and recomputing all hashes.",toolCalls:[]}:{message:`I'm the Kontext demo agent with access to financial tools. I can:

- **Send USDC** - e.g., "Send $5,000 USDC to 0x742d...bD1E"
- **Check balance** - e.g., "Check my wallet balance"
- **View trust score** - e.g., "What's my trust score?"

Every action is logged to a tamper-evident SHA-256 digest chain with automatic OFAC sanctions screening and compliance checks.`,toolCalls:[]}}(t);for(let e of r.toolCalls)if(await i.log({type:"ai_tool_call",description:`Tool call: ${e.name}`,agentId:n,metadata:{toolName:e.name,args:e.args}}),"transfer_usdc"===e.name||"send_payment"===e.name){let t=String(e.args.amount||"0"),r=String(e.args.to||"0x0000000000000000000000000000000000000000");await i.log({type:"ai_financial_tool_call",description:`Financial tool "${e.name}" invoked with amount ${t} USDC`,agentId:n,metadata:{toolName:e.name,amount:t,currency:"USDC",toolArgs:e.args}});let s=e.result.txHash||U();await i.logTransaction({txHash:s,chain:"base",amount:t,token:"USDC",from:"0x1234567890abcdef1234567890abcdef12345678",to:r,agentId:n,metadata:{source:"demo",toolName:e.name}})}await i.log({type:"ai_response",description:`AI response generated (${r.message.length} chars)`,agentId:n,metadata:{responseLength:r.message.length,toolCallCount:r.toolCalls.length}});let s=null,a=r.toolCalls.find(e=>"transfer_usdc"===e.name||"send_payment"===e.name);if(a){let e=String(a.args.to||"0x0000000000000000000000000000000000000000"),t=String(a.args.amount||"0");s=i.checkUsdcCompliance({txHash:a.result.txHash||U(),chain:"base",amount:t,token:"USDC",from:"0x1234567890abcdef1234567890abcdef12345678",to:e,agentId:n}),await i.log({type:"compliance_check",description:`USDC compliance check: ${s.compliant?"PASSED":"FAILED"} (risk: ${s.riskLevel})`,agentId:n,metadata:{compliant:s.compliant,riskLevel:s.riskLevel,checkCount:s.checks.length,passedCount:s.checks.filter(e=>e.passed).length,recommendations:s.recommendations}})}let o=i.getActions(),c=i.exportDigestChain(),d=await i.getTrustScore(n),u=i.verifyDigestChain();return l.NextResponse.json({message:r.message,toolCalls:r.toolCalls,actions:o.map(e=>({id:e.id,timestamp:e.timestamp,type:e.type,description:e.description,digest:e.digest,metadata:e.metadata})),chain:{genesisHash:c.genesisHash,terminalDigest:c.terminalDigest,length:c.links.length,links:c.links.slice(-8).map(e=>({digest:e.digest,priorDigest:e.priorDigest,sequence:e.sequence,actionId:e.actionId})),verified:u.valid,linksVerified:u.linksVerified},trustScore:{score:d.score,level:d.level,factors:d.factors},complianceResult:s?{compliant:s.compliant,riskLevel:s.riskLevel,checks:s.checks,recommendations:s.recommendations}:null})}catch(e){return console.error("Chat API error:",e),l.NextResponse.json({error:e instanceof Error?e.message:"Internal server error"},{status:500})}}async function B(){try{let e=M(),t=e.getActions(),i=e.exportDigestChain(),n=await e.getTrustScore("demo-agent"),r=e.verifyDigestChain();return l.NextResponse.json({actions:t.map(e=>({id:e.id,timestamp:e.timestamp,type:e.type,description:e.description,digest:e.digest,metadata:e.metadata})),chain:{genesisHash:i.genesisHash,terminalDigest:i.terminalDigest,length:i.links.length,links:i.links.slice(-8).map(e=>({digest:e.digest,priorDigest:e.priorDigest,sequence:e.sequence,actionId:e.actionId})),verified:r.valid,linksVerified:r.linksVerified},trustScore:{score:n.score,level:n.level,factors:n.factors}})}catch(e){return console.error("Chat GET error:",e),l.NextResponse.json({error:e instanceof Error?e.message:"Internal server error"},{status:500})}}let z=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"/Users/vinn/Documents/kontext-verify-new/apps/demo/src/app/api/chat/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:K,staticGenerationAsyncStorage:V,serverHooks:W}=z,G="/api/chat/route";function X(){return(0,o.patchFetch)({serverHooks:W,staticGenerationAsyncStorage:V})}},9925:e=>{"use strict";var t=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,s={};function a(e){var t;let i=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),n=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===i.length?n:`${n}; ${i.join("; ")}`}function o(e){let t=new Map;for(let i of e.split(/; */)){if(!i)continue;let e=i.indexOf("=");if(-1===e){t.set(i,"true");continue}let[n,r]=[i.slice(0,e),i.slice(e+1)];try{t.set(n,decodeURIComponent(null!=r?r:"true"))}catch{}}return t}function l(e){var t,i;if(!e)return;let[[n,r],...s]=o(e),{domain:a,expires:l,httponly:u,maxage:h,path:g,samesite:p,secure:m,partitioned:f,priority:b}=Object.fromEntries(s.map(([e,t])=>[e.toLowerCase(),t]));return function(e){let t={};for(let i in e)e[i]&&(t[i]=e[i]);return t}({name:n,value:decodeURIComponent(r),domain:a,...l&&{expires:new Date(l)},...u&&{httpOnly:!0},..."string"==typeof h&&{maxAge:Number(h)},path:g,...p&&{sameSite:c.includes(t=(t=p).toLowerCase())?t:void 0},...m&&{secure:!0},...b&&{priority:d.includes(i=(i=b).toLowerCase())?i:void 0},...f&&{partitioned:!0}})}((e,i)=>{for(var n in i)t(e,n,{get:i[n],enumerable:!0})})(s,{RequestCookies:()=>u,ResponseCookies:()=>h,parseCookie:()=>o,parseSetCookie:()=>l,stringifyCookie:()=>a}),e.exports=((e,s,a,o)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let a of n(s))r.call(e,a)||void 0===a||t(e,a,{get:()=>s[a],enumerable:!(o=i(s,a))||o.enumerable});return e})(t({},"__esModule",{value:!0}),s);var c=["strict","lax","none"],d=["low","medium","high"],u=class{constructor(e){this._parsed=new Map,this._headers=e;let t=e.get("cookie");if(t)for(let[e,i]of o(t))this._parsed.set(e,{name:e,value:i})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let i=Array.from(this._parsed);if(!e.length)return i.map(([e,t])=>t);let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return i.filter(([e])=>e===n).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,i]=1===e.length?[e[0].name,e[0].value]:e,n=this._parsed;return n.set(t,{name:t,value:i}),this._headers.set("cookie",Array.from(n).map(([e,t])=>a(t)).join("; ")),this}delete(e){let t=this._parsed,i=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>a(t)).join("; ")),i}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},h=class{constructor(e){var t,i,n;this._parsed=new Map,this._headers=e;let r=null!=(n=null!=(i=null==(t=e.getSetCookie)?void 0:t.call(e))?i:e.get("set-cookie"))?n:[];for(let e of Array.isArray(r)?r:function(e){if(!e)return[];var t,i,n,r,s,a=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,s=!1;l();)if(","===(i=e.charAt(o))){for(n=o,o+=1,l(),r=o;o<e.length&&"="!==(i=e.charAt(o))&&";"!==i&&","!==i;)o+=1;o<e.length&&"="===e.charAt(o)?(s=!0,o=r,a.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!s||o>=e.length)&&a.push(e.substring(t,e.length))}return a}(r)){let t=l(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let i=Array.from(this._parsed.values());if(!e.length)return i;let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return i.filter(e=>e.name===n)}has(e){return this._parsed.has(e)}set(...e){let[t,i,n]=1===e.length?[e[0].name,e[0].value,e[0]]:e,r=this._parsed;return r.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:i,...n})),function(e,t){for(let[,i]of(t.delete("set-cookie"),e)){let e=a(i);t.append("set-cookie",e)}}(r,this._headers),this}delete(...e){let[t,i,n]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0].path,e[0].domain];return this.set({name:t,path:i,domain:n,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(a).join("; ")}}},8346:(e,t,i)=>{var n;(()=>{var r={226:function(r,s){!function(a,o){"use strict";var l="function",c="undefined",d="object",u="string",h="major",g="model",p="name",m="type",f="vendor",b="version",w="architecture",y="console",v="mobile",A="tablet",k="smarttv",x="wearable",I="embedded",T="Amazon",R="Apple",S="ASUS",C="BlackBerry",D="Browser",_="Chrome",O="Firefox",E="Google",N="Huawei",P="Microsoft",$="Motorola",j="Opera",q="Samsung",L="Sharp",F="Sony",M="Xiaomi",U="Zebra",H="Facebook",B="Chromium OS",z="Mac OS",K=function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i},V=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},W=function(e,t){return typeof e===u&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},X=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===c?e:e.substring(0,350)},J=function(e,t){for(var i,n,r,s,a,c,u=0;u<t.length&&!a;){var h=t[u],g=t[u+1];for(i=n=0;i<h.length&&!a&&h[i];)if(a=h[i++].exec(e))for(r=0;r<g.length;r++)c=a[++n],typeof(s=g[r])===d&&s.length>0?2===s.length?typeof s[1]==l?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==l||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):void 0:this[s[0]]=c?s[1].call(this,c,s[2]):void 0:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):void 0):this[s]=c||o;u+=2}},Y=function(e,t){for(var i in t)if(typeof t[i]===d&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(W(t[i][n],e))return"?"===i?o:i}else if(W(t[i],e))return"?"===i?o:i;return e},Z={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,b],[/opios[\/ ]+([\w\.]+)/i],[b,[p,j+" Mini"]],[/\bopr\/([\w\.]+)/i],[b,[p,j]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,b],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[p,"UC"+D]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[b,[p,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[b,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[b,[p,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+D],b],[/\bfocus\/([\w\.]+)/i],[b,[p,O+" Focus"]],[/\bopt\/([\w\.]+)/i],[b,[p,j+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[p,j+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[p,"MIUI "+D]],[/fxios\/([-\w\.]+)/i],[b,[p,O]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+D]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+D],b],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[p,b],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,H],b],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[p,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[b,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[p,_+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,_+" WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[p,"Android "+D]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,b],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[b,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[b,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[b,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[p,O+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,b],[/(cobalt)\/([\w\.]+)/i],[p,[b,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[w,"amd64"]],[/(ia32(?=;))/i],[[w,G]],[/((?:i[346]|x)86)[;\)]/i],[[w,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[w,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[w,"armhf"]],[/windows (ce|mobile); ppc;/i],[[w,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[w,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[w,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[w,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[g,[f,q],[m,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[g,[f,q],[m,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[g,[f,R],[m,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[g,[f,R],[m,A]],[/(macintosh);/i],[g,[f,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[g,[f,L],[m,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[g,[f,N],[m,A]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[g,[f,N],[m,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[g,/_/g," "],[f,M],[m,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[g,/_/g," "],[f,M],[m,A]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[g,[f,"OPPO"],[m,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[g,[f,"Vivo"],[m,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[g,[f,"Realme"],[m,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[g,[f,$],[m,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[g,[f,$],[m,A]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[g,[f,"LG"],[m,A]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[g,[f,"LG"],[m,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[g,[f,"Lenovo"],[m,A]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[g,/_/g," "],[f,"Nokia"],[m,v]],[/(pixel c)\b/i],[g,[f,E],[m,A]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[g,[f,E],[m,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[g,[f,F],[m,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[g,"Xperia Tablet"],[f,F],[m,A]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[g,[f,"OnePlus"],[m,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[g,[f,T],[m,A]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[g,/(.+)/g,"Fire Phone $1"],[f,T],[m,v]],[/(playbook);[-\w\),; ]+(rim)/i],[g,f,[m,A]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[g,[f,C],[m,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[g,[f,S],[m,A]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[g,[f,S],[m,v]],[/(nexus 9)/i],[g,[f,"HTC"],[m,A]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[g,/_/g," "],[m,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[g,[f,"Acer"],[m,A]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[g,[f,"Meizu"],[m,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,g,[m,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,g,[m,A]],[/(surface duo)/i],[g,[f,P],[m,A]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[g,[f,"Fairphone"],[m,v]],[/(u304aa)/i],[g,[f,"AT&T"],[m,v]],[/\bsie-(\w*)/i],[g,[f,"Siemens"],[m,v]],[/\b(rct\w+) b/i],[g,[f,"RCA"],[m,A]],[/\b(venue[\d ]{2,7}) b/i],[g,[f,"Dell"],[m,A]],[/\b(q(?:mv|ta)\w+) b/i],[g,[f,"Verizon"],[m,A]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[g,[f,"Barnes & Noble"],[m,A]],[/\b(tm\d{3}\w+) b/i],[g,[f,"NuVision"],[m,A]],[/\b(k88) b/i],[g,[f,"ZTE"],[m,A]],[/\b(nx\d{3}j) b/i],[g,[f,"ZTE"],[m,v]],[/\b(gen\d{3}) b.+49h/i],[g,[f,"Swiss"],[m,v]],[/\b(zur\d{3}) b/i],[g,[f,"Swiss"],[m,A]],[/\b((zeki)?tb.*\b) b/i],[g,[f,"Zeki"],[m,A]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],g,[m,A]],[/\b(ns-?\w{0,9}) b/i],[g,[f,"Insignia"],[m,A]],[/\b((nxa|next)-?\w{0,9}) b/i],[g,[f,"NextBook"],[m,A]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],g,[m,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],g,[m,v]],[/\b(ph-1) /i],[g,[f,"Essential"],[m,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[g,[f,"Envizen"],[m,A]],[/\b(trio[-\w\. ]+) b/i],[g,[f,"MachSpeed"],[m,A]],[/\btu_(1491) b/i],[g,[f,"Rotor"],[m,A]],[/(shield[\w ]+) b/i],[g,[f,"Nvidia"],[m,A]],[/(sprint) (\w+)/i],[f,g,[m,v]],[/(kin\.[onetw]{3})/i],[[g,/\./g," "],[f,P],[m,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[g,[f,U],[m,A]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[g,[f,U],[m,v]],[/smart-tv.+(samsung)/i],[f,[m,k]],[/hbbtv.+maple;(\d+)/i],[[g,/^/,"SmartTV"],[f,q],[m,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,"LG"],[m,k]],[/(apple) ?tv/i],[f,[g,R+" TV"],[m,k]],[/crkey/i],[[g,_+"cast"],[f,E],[m,k]],[/droid.+aft(\w)( bui|\))/i],[g,[f,T],[m,k]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[g,[f,L],[m,k]],[/(bravia[\w ]+)( bui|\))/i],[g,[f,F],[m,k]],[/(mitv-\w{5}) bui/i],[g,[f,M],[m,k]],[/Hbbtv.*(technisat) (.*);/i],[f,g,[m,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,X],[g,X],[m,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,k]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,g,[m,y]],[/droid.+; (shield) bui/i],[g,[f,"Nvidia"],[m,y]],[/(playstation [345portablevi]+)/i],[g,[f,F],[m,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[g,[f,P],[m,y]],[/((pebble))app/i],[f,g,[m,x]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[g,[f,R],[m,x]],[/droid.+; (glass) \d/i],[g,[f,E],[m,x]],[/droid.+; (wt63?0{2,3})\)/i],[g,[f,U],[m,x]],[/(quest( 2| pro)?)/i],[g,[f,H],[m,x]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[m,I]],[/(aeobc)\b/i],[g,[f,T],[m,I]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[g,[m,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[g,[m,A]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,A]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,v]],[/(android[-\w\. ]{0,9});.+buil/i],[g,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,b],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,b],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[p,[b,Y,Z]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,"Windows"],[b,Y,Z]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,z],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[b,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,b],[/\(bb(10);/i],[b,[p,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[b,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[p,O+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[b,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[b,[p,_+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,B],b],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,b],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,b]]},ee=function(e,t){if(typeof e===d&&(t=e,e=o),!(this instanceof ee))return new ee(e,t).getResult();var i=typeof a!==c&&a.navigator?a.navigator:o,n=e||(i&&i.userAgent?i.userAgent:""),r=i&&i.userAgentData?i.userAgentData:o,s=t?K(Q,t):Q,y=i&&i.userAgent==n;return this.getBrowser=function(){var e,t={};return t[p]=o,t[b]=o,J.call(t,n,s.browser),t[h]=typeof(e=t[b])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o,y&&i&&i.brave&&typeof i.brave.isBrave==l&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[w]=o,J.call(e,n,s.cpu),e},this.getDevice=function(){var e={};return e[f]=o,e[g]=o,e[m]=o,J.call(e,n,s.device),y&&!e[m]&&r&&r.mobile&&(e[m]=v),y&&"Macintosh"==e[g]&&i&&typeof i.standalone!==c&&i.maxTouchPoints&&i.maxTouchPoints>2&&(e[g]="iPad",e[m]=A),e},this.getEngine=function(){var e={};return e[p]=o,e[b]=o,J.call(e,n,s.engine),e},this.getOS=function(){var e={};return e[p]=o,e[b]=o,J.call(e,n,s.os),y&&!e[p]&&r&&"Unknown"!=r.platform&&(e[p]=r.platform.replace(/chrome os/i,B).replace(/macos/i,z)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===u&&e.length>350?X(e,350):e,this},this.setUA(n),this};ee.VERSION="1.0.35",ee.BROWSER=V([p,b,h]),ee.CPU=V([w]),ee.DEVICE=V([g,f,m,y,v,k,A,x,I]),ee.ENGINE=ee.OS=V([p,b]),typeof s!==c?(r.exports&&(s=r.exports=ee),s.UAParser=ee):i.amdO?void 0!==(n=(function(){return ee}).call(t,i,t,e))&&(e.exports=n):typeof a!==c&&(a.UAParser=ee);var et=typeof a!==c&&(a.jQuery||a.Zepto);if(et&&!et.ua){var ei=new ee;et.ua=ei.getResult(),et.ua.get=function(){return ei.getUA()},et.ua.set=function(e){ei.setUA(e);var t=ei.getResult();for(var i in t)et.ua[i]=t[i]}}}("object"==typeof window?window:this)}},s={};function a(e){var t=s[e];if(void 0!==t)return t.exports;var i=s[e]={exports:{}},n=!0;try{r[e].call(i.exports,i,i.exports,a),n=!1}finally{n&&delete s[e]}return i.exports}a.ab=__dirname+"/";var o=a(226);e.exports=o})()},9303:(e,t,i)=>{"use strict";e.exports=i(517)},44:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{PageSignatureError:function(){return i},RemovedPageError:function(){return n},RemovedUAError:function(){return r}});class i extends Error{constructor({page:e}){super(`The middleware "${e}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class n extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class r extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},8277:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{ImageResponse:function(){return n.ImageResponse},NextRequest:function(){return r.NextRequest},NextResponse:function(){return s.NextResponse},URLPattern:function(){return o.URLPattern},userAgent:function(){return a.userAgent},userAgentFromString:function(){return a.userAgentFromString}});let n=i(6),r=i(9745),s=i(9211),a=i(8471),o=i(2433)},9247:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextURL",{enumerable:!0,get:function(){return d}});let n=i(3777),r=i(3817),s=i(1675),a=i(6111),o=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function l(e,t){return new URL(String(e).replace(o,"localhost"),t&&String(t).replace(o,"localhost"))}let c=Symbol("NextURLInternal");class d{constructor(e,t,i){let n,r;"object"==typeof t&&"pathname"in t||"string"==typeof t?(n=t,r=i||{}):r=i||t||{},this[c]={url:l(e,n??r.base),options:r,basePath:""},this.analyze()}analyze(){var e,t,i,r,o;let l=(0,a.getNextPathnameInfo)(this[c].url.pathname,{nextConfig:this[c].options.nextConfig,parseData:!0,i18nProvider:this[c].options.i18nProvider}),d=(0,s.getHostname)(this[c].url,this[c].options.headers);this[c].domainLocale=this[c].options.i18nProvider?this[c].options.i18nProvider.detectDomainLocale(d):(0,n.detectDomainLocale)(null==(t=this[c].options.nextConfig)?void 0:null==(e=t.i18n)?void 0:e.domains,d);let u=(null==(i=this[c].domainLocale)?void 0:i.defaultLocale)||(null==(o=this[c].options.nextConfig)?void 0:null==(r=o.i18n)?void 0:r.defaultLocale);this[c].url.pathname=l.pathname,this[c].defaultLocale=u,this[c].basePath=l.basePath??"",this[c].buildId=l.buildId,this[c].locale=l.locale??u,this[c].trailingSlash=l.trailingSlash}formatPathname(){return(0,r.formatNextPathnameInfo)({basePath:this[c].basePath,buildId:this[c].buildId,defaultLocale:this[c].options.forceLocale?void 0:this[c].defaultLocale,locale:this[c].locale,pathname:this[c].url.pathname,trailingSlash:this[c].trailingSlash})}formatSearch(){return this[c].url.search}get buildId(){return this[c].buildId}set buildId(e){this[c].buildId=e}get locale(){return this[c].locale??""}set locale(e){var t,i;if(!this[c].locale||!(null==(i=this[c].options.nextConfig)?void 0:null==(t=i.i18n)?void 0:t.locales.includes(e)))throw TypeError(`The NextURL configuration includes no locale "${e}"`);this[c].locale=e}get defaultLocale(){return this[c].defaultLocale}get domainLocale(){return this[c].domainLocale}get searchParams(){return this[c].url.searchParams}get host(){return this[c].url.host}set host(e){this[c].url.host=e}get hostname(){return this[c].url.hostname}set hostname(e){this[c].url.hostname=e}get port(){return this[c].url.port}set port(e){this[c].url.port=e}get protocol(){return this[c].url.protocol}set protocol(e){this[c].url.protocol=e}get href(){let e=this.formatPathname(),t=this.formatSearch();return`${this.protocol}//${this.host}${e}${t}${this.hash}`}set href(e){this[c].url=l(e),this.analyze()}get origin(){return this[c].url.origin}get pathname(){return this[c].url.pathname}set pathname(e){this[c].url.pathname=e}get hash(){return this[c].url.hash}set hash(e){this[c].url.hash=e}get search(){return this[c].url.search}set search(e){this[c].url.search=e}get password(){return this[c].url.password}set password(e){this[c].url.password=e}get username(){return this[c].url.username}set username(e){this[c].url.username=e}get basePath(){return this[c].basePath}set basePath(e){this[c].basePath=e.startsWith("/")?e:`/${e}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new d(String(this),this[c].options)}}},2044:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{RequestCookies:function(){return n.RequestCookies},ResponseCookies:function(){return n.ResponseCookies},stringifyCookie:function(){return n.stringifyCookie}});let n=i(9925)},6:(e,t)=>{"use strict";function i(){throw Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead')}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ImageResponse",{enumerable:!0,get:function(){return i}})},9745:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{INTERNALS:function(){return o},NextRequest:function(){return l}});let n=i(9247),r=i(7636),s=i(44),a=i(2044),o=Symbol("internal request");class l extends Request{constructor(e,t={}){let i="string"!=typeof e&&"url"in e?e.url:String(e);(0,r.validateURL)(i),e instanceof Request?super(e,t):super(i,t);let s=new n.NextURL(i,{headers:(0,r.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:t.nextConfig});this[o]={cookies:new a.RequestCookies(this.headers),geo:t.geo||{},ip:t.ip,nextUrl:s,url:s.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[o].cookies}get geo(){return this[o].geo}get ip(){return this[o].ip}get nextUrl(){return this[o].nextUrl}get page(){throw new s.RemovedPageError}get ua(){throw new s.RemovedUAError}get url(){return this[o].url}}},9211:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NextResponse",{enumerable:!0,get:function(){return u}});let n=i(2044),r=i(9247),s=i(7636),a=i(8238),o=i(2044),l=Symbol("internal response"),c=new Set([301,302,303,307,308]);function d(e,t){var i;if(null==e?void 0:null==(i=e.request)?void 0:i.headers){if(!(e.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let i=[];for(let[n,r]of e.request.headers)t.set("x-middleware-request-"+n,r),i.push(n);t.set("x-middleware-override-headers",i.join(","))}}class u extends Response{constructor(e,t={}){super(e,t);let i=this.headers,c=new Proxy(new o.ResponseCookies(i),{get(e,r,s){switch(r){case"delete":case"set":return(...s)=>{let a=Reflect.apply(e[r],e,s),l=new Headers(i);return a instanceof o.ResponseCookies&&i.set("x-middleware-set-cookie",a.getAll().map(e=>(0,n.stringifyCookie)(e)).join(",")),d(t,l),a};default:return a.ReflectAdapter.get(e,r,s)}}});this[l]={cookies:c,url:t.url?new r.NextURL(t.url,{headers:(0,s.toNodeOutgoingHttpHeaders)(i),nextConfig:t.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[l].cookies}static json(e,t){let i=Response.json(e,t);return new u(i.body,i)}static redirect(e,t){let i="number"==typeof t?t:(null==t?void 0:t.status)??307;if(!c.has(i))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let n="object"==typeof t?t:{},r=new Headers(null==n?void 0:n.headers);return r.set("Location",(0,s.validateURL)(e)),new u(null,{...n,headers:r,status:i})}static rewrite(e,t){let i=new Headers(null==t?void 0:t.headers);return i.set("x-middleware-rewrite",(0,s.validateURL)(e)),d(t,i),new u(null,{...t,headers:i})}static next(e){let t=new Headers(null==e?void 0:e.headers);return t.set("x-middleware-next","1"),d(e,t),new u(null,{...e,headers:t})}}},2433:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"URLPattern",{enumerable:!0,get:function(){return i}});let i="undefined"==typeof URLPattern?void 0:URLPattern},8471:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{isBot:function(){return r},userAgent:function(){return a},userAgentFromString:function(){return s}});let n=function(e){return e&&e.__esModule?e:{default:e}}(i(8346));function r(e){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(e)}function s(e){return{...(0,n.default)(e),isBot:void 0!==e&&r(e)}}function a({headers:e}){return s(e.get("user-agent")||void 0)}},7636:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{fromNodeOutgoingHttpHeaders:function(){return r},normalizeNextQueryParam:function(){return l},splitCookiesString:function(){return s},toNodeOutgoingHttpHeaders:function(){return a},validateURL:function(){return o}});let n=i(1943);function r(e){let t=new Headers;for(let[i,n]of Object.entries(e))for(let e of Array.isArray(n)?n:[n])void 0!==e&&("number"==typeof e&&(e=e.toString()),t.append(i,e));return t}function s(e){var t,i,n,r,s,a=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,s=!1;l();)if(","===(i=e.charAt(o))){for(n=o,o+=1,l(),r=o;o<e.length&&"="!==(i=e.charAt(o))&&";"!==i&&","!==i;)o+=1;o<e.length&&"="===e.charAt(o)?(s=!0,o=r,a.push(e.substring(t,n)),t=o):o=n+1}else o+=1;(!s||o>=e.length)&&a.push(e.substring(t,e.length))}return a}function a(e){let t={},i=[];if(e)for(let[n,r]of e.entries())"set-cookie"===n.toLowerCase()?(i.push(...s(r)),t[n]=1===i.length?i[0]:i):t[n]=r;return t}function o(e){try{return String(new URL(String(e)))}catch(t){throw Error(`URL is malformed "${String(e)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:t})}}function l(e,t){for(let i of[n.NEXT_QUERY_PARAM_PREFIX,n.NEXT_INTERCEPTION_MARKER_PREFIX])e!==i&&e.startsWith(i)&&t(e.substring(i.length))}},1675:(e,t)=>{"use strict";function i(e,t){let i;if((null==t?void 0:t.host)&&!Array.isArray(t.host))i=t.host.toString().split(":",1)[0];else{if(!e.hostname)return;i=e.hostname}return i.toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getHostname",{enumerable:!0,get:function(){return i}})},3777:(e,t)=>{"use strict";function i(e,t,i){if(e)for(let s of(i&&(i=i.toLowerCase()),e)){var n,r;if(t===(null==(n=s.domain)?void 0:n.split(":",1)[0].toLowerCase())||i===s.defaultLocale.toLowerCase()||(null==(r=s.locales)?void 0:r.some(e=>e.toLowerCase()===i)))return s}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"detectDomainLocale",{enumerable:!0,get:function(){return i}})},5014:(e,t)=>{"use strict";function i(e,t){let i;let n=e.split("/");return(t||[]).some(t=>!!n[1]&&n[1].toLowerCase()===t.toLowerCase()&&(i=t,n.splice(1,1),e=n.join("/")||"/",!0)),{pathname:e,detectedLocale:i}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"normalizeLocalePath",{enumerable:!0,get:function(){return i}})},225:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return s}});let n=i(1041),r=i(4329);function s(e,t,i,s){if(!t||t===i)return e;let a=e.toLowerCase();return!s&&((0,r.pathHasPrefix)(a,"/api")||(0,r.pathHasPrefix)(a,"/"+t.toLowerCase()))?e:(0,n.addPathPrefix)(e,"/"+t)}},1041:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathPrefix",{enumerable:!0,get:function(){return r}});let n=i(1693);function r(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:i,query:r,hash:s}=(0,n.parsePath)(e);return""+t+i+r+s}},8166:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addPathSuffix",{enumerable:!0,get:function(){return r}});let n=i(1693);function r(e,t){if(!e.startsWith("/")||!t)return e;let{pathname:i,query:r,hash:s}=(0,n.parsePath)(e);return""+i+t+r+s}},3817:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"formatNextPathnameInfo",{enumerable:!0,get:function(){return o}});let n=i(7847),r=i(1041),s=i(8166),a=i(225);function o(e){let t=(0,a.addLocale)(e.pathname,e.locale,e.buildId?void 0:e.defaultLocale,e.ignorePrefix);return(e.buildId||!e.trailingSlash)&&(t=(0,n.removeTrailingSlash)(t)),e.buildId&&(t=(0,s.addPathSuffix)((0,r.addPathPrefix)(t,"/_next/data/"+e.buildId),"/"===e.pathname?"index.json":".json")),t=(0,r.addPathPrefix)(t,e.basePath),!e.buildId&&e.trailingSlash?t.endsWith("/")?t:(0,s.addPathSuffix)(t,"/"):(0,n.removeTrailingSlash)(t)}},6111:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getNextPathnameInfo",{enumerable:!0,get:function(){return a}});let n=i(5014),r=i(9529),s=i(4329);function a(e,t){var i,a;let{basePath:o,i18n:l,trailingSlash:c}=null!=(i=t.nextConfig)?i:{},d={pathname:e,trailingSlash:"/"!==e?e.endsWith("/"):c};o&&(0,s.pathHasPrefix)(d.pathname,o)&&(d.pathname=(0,r.removePathPrefix)(d.pathname,o),d.basePath=o);let u=d.pathname;if(d.pathname.startsWith("/_next/data/")&&d.pathname.endsWith(".json")){let e=d.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),i=e[0];d.buildId=i,u="index"!==e[1]?"/"+e.slice(1).join("/"):"/",!0===t.parseData&&(d.pathname=u)}if(l){let e=t.i18nProvider?t.i18nProvider.analyze(d.pathname):(0,n.normalizeLocalePath)(d.pathname,l.locales);d.locale=e.detectedLocale,d.pathname=null!=(a=e.pathname)?a:d.pathname,!e.detectedLocale&&d.buildId&&(e=t.i18nProvider?t.i18nProvider.analyze(u):(0,n.normalizeLocalePath)(u,l.locales)).detectedLocale&&(d.locale=e.detectedLocale)}return d}},1693:(e,t)=>{"use strict";function i(e){let t=e.indexOf("#"),i=e.indexOf("?"),n=i>-1&&(t<0||i<t);return n||t>-1?{pathname:e.substring(0,n?i:t),query:n?e.substring(i,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"parsePath",{enumerable:!0,get:function(){return i}})},4329:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"pathHasPrefix",{enumerable:!0,get:function(){return r}});let n=i(1693);function r(e,t){if("string"!=typeof e)return!1;let{pathname:i}=(0,n.parsePath)(e);return i===t||i.startsWith(t+"/")}},9529:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removePathPrefix",{enumerable:!0,get:function(){return r}});let n=i(4329);function r(e,t){if(!(0,n.pathHasPrefix)(e,t))return e;let i=e.slice(t.length);return i.startsWith("/")?i:"/"+i}},7847:(e,t)=>{"use strict";function i(e){return e.replace(/\/$/,"")||"/"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"removeTrailingSlash",{enumerable:!0,get:function(){return i}})}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),n=t.X(0,[276],()=>i(1748));module.exports=n})();